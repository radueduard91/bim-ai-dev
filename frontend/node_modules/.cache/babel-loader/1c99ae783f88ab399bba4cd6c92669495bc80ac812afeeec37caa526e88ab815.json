{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useMemo } from 'react';\nimport { organizeDataForVisualization, organizeDataForAIRearrangement } from '../utils/dataOrganizer';\n\n/**\r\n * Custom hook to manage graph visualization state and data processing\r\n */\nconst useGraphVisualization = graphData => {\n  _s();\n  // State for view modes and data\n  const [processedData, setProcessedData] = useState([]);\n  const [aiProcessedData, setAIProcessedData] = useState([]);\n  const [show3NFStatus, setShow3NFStatus] = useState(false);\n  const [showAIRearrangement, setShowAIRearrangement] = useState(false);\n  const [expandedAttributes, setExpandedAttributes] = useState({});\n  const [showDefinitions, setShowDefinitions] = useState(false);\n\n  // Process graph data when it changes\n  useEffect(() => {\n    if (graphData && graphData.nodeDataArray && graphData.linkDataArray) {\n      try {\n        // Process original data organization\n        const organized = organizeDataForVisualization(graphData);\n        setProcessedData(organized);\n\n        // Process AI-rearranged data\n        const aiOrganized = organizeDataForAIRearrangement(graphData);\n        setAIProcessedData(aiOrganized);\n\n        // Reset expanded state when data changes\n        setExpandedAttributes({});\n      } catch (error) {\n        console.error('Error processing graph data:', error);\n        setProcessedData([]);\n        setAIProcessedData([]);\n      }\n    }\n  }, [graphData]);\n\n  // Toggle 3NF compliance check display\n  const toggle3NFCheck = () => {\n    setShow3NFStatus(prev => !prev);\n  };\n\n  // Toggle AI rearrangement display\n  const toggleAIRearrangement = () => {\n    setShowAIRearrangement(prev => !prev);\n\n    // Reset expanded state when switching views\n    if (!showAIRearrangement) {\n      setExpandedAttributes({});\n    }\n  };\n\n  // Toggle show definitions\n  const toggleShowDefinitions = () => {\n    setShowDefinitions(prev => !prev);\n  };\n\n  // Toggle expand/collapse for an attribute\n  const toggleExpand = (objectKey, attrName) => {\n    setExpandedAttributes(prev => {\n      const key = `${objectKey}-${attrName}`;\n      return {\n        ...prev,\n        [key]: !prev[key]\n      };\n    });\n  };\n\n  // Check if an attribute is expanded\n  const isExpanded = (objectKey, attrName) => {\n    const key = `${objectKey}-${attrName}`;\n    return !!expandedAttributes[key];\n  };\n\n  // Download VP Template function\n  const handleDownloadTemplate = () => {\n    try {\n      // API endpoint URL\n      const templateUrl = 'http://localhost:8000/api/templates/ai_template.xlsx';\n\n      // Create a temporary anchor element to trigger download\n      const link = document.createElement('a');\n      link.href = templateUrl;\n      link.download = 'AI VP Template.xlsx'; // File name for download\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      console.log('Template download initiated');\n    } catch (error) {\n      console.error('Error downloading template:', error);\n      // Fallback method if direct download doesn't work\n      window.open('http://localhost:8000/api/templates/ai_template.xlsx', '_blank');\n    }\n  };\n  return {\n    processedData,\n    aiProcessedData,\n    show3NFStatus,\n    showAIRearrangement,\n    showDefinitions,\n    toggleAIRearrangement,\n    toggle3NFCheck,\n    toggleShowDefinitions,\n    isExpanded,\n    toggleExpand,\n    handleDownloadTemplate\n  };\n};\n_s(useGraphVisualization, \"ZlgEc4XAWorJHWExgbbC2SHoB/M=\");\nexport default useGraphVisualization;","map":{"version":3,"names":["useState","useEffect","useMemo","organizeDataForVisualization","organizeDataForAIRearrangement","useGraphVisualization","graphData","_s","processedData","setProcessedData","aiProcessedData","setAIProcessedData","show3NFStatus","setShow3NFStatus","showAIRearrangement","setShowAIRearrangement","expandedAttributes","setExpandedAttributes","showDefinitions","setShowDefinitions","nodeDataArray","linkDataArray","organized","aiOrganized","error","console","toggle3NFCheck","prev","toggleAIRearrangement","toggleShowDefinitions","toggleExpand","objectKey","attrName","key","isExpanded","handleDownloadTemplate","templateUrl","link","document","createElement","href","download","body","appendChild","click","removeChild","log","window","open"],"sources":["C:/Users/R40008/Asset Model Server/python/bim-ai-dev/frontend/src/components/TableGraphVisualization/hooks/useGraphVisualization.js"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\r\nimport { \r\n  organizeDataForVisualization, \r\n  organizeDataForAIRearrangement \r\n} from '../utils/dataOrganizer';\r\n\r\n/**\r\n * Custom hook to manage graph visualization state and data processing\r\n */\r\nconst useGraphVisualization = (graphData) => {\r\n  // State for view modes and data\r\n  const [processedData, setProcessedData] = useState([]);\r\n  const [aiProcessedData, setAIProcessedData] = useState([]);\r\n  const [show3NFStatus, setShow3NFStatus] = useState(false);\r\n  const [showAIRearrangement, setShowAIRearrangement] = useState(false);\r\n  const [expandedAttributes, setExpandedAttributes] = useState({});\r\n  const [showDefinitions, setShowDefinitions] = useState(false);\r\n\r\n  // Process graph data when it changes\r\n  useEffect(() => {\r\n    if (graphData && graphData.nodeDataArray && graphData.linkDataArray) {\r\n      try {\r\n        // Process original data organization\r\n        const organized = organizeDataForVisualization(graphData);\r\n        setProcessedData(organized);\r\n        \r\n        // Process AI-rearranged data\r\n        const aiOrganized = organizeDataForAIRearrangement(graphData);\r\n        setAIProcessedData(aiOrganized);\r\n        \r\n        // Reset expanded state when data changes\r\n        setExpandedAttributes({});\r\n      } catch (error) {\r\n        console.error('Error processing graph data:', error);\r\n        setProcessedData([]);\r\n        setAIProcessedData([]);\r\n      }\r\n    }\r\n  }, [graphData]);\r\n\r\n  // Toggle 3NF compliance check display\r\n  const toggle3NFCheck = () => {\r\n    setShow3NFStatus(prev => !prev);\r\n  };\r\n  \r\n  // Toggle AI rearrangement display\r\n  const toggleAIRearrangement = () => {\r\n    setShowAIRearrangement(prev => !prev);\r\n    \r\n    // Reset expanded state when switching views\r\n    if (!showAIRearrangement) {\r\n      setExpandedAttributes({});\r\n    }\r\n  };\r\n\r\n  // Toggle show definitions\r\n  const toggleShowDefinitions = () => {\r\n    setShowDefinitions(prev => !prev);\r\n  };\r\n\r\n  // Toggle expand/collapse for an attribute\r\n  const toggleExpand = (objectKey, attrName) => {\r\n    setExpandedAttributes(prev => {\r\n      const key = `${objectKey}-${attrName}`;\r\n      return {\r\n        ...prev,\r\n        [key]: !prev[key]\r\n      };\r\n    });\r\n  };\r\n\r\n  // Check if an attribute is expanded\r\n  const isExpanded = (objectKey, attrName) => {\r\n    const key = `${objectKey}-${attrName}`;\r\n    return !!expandedAttributes[key];\r\n  };\r\n  \r\n  // Download VP Template function\r\n  const handleDownloadTemplate = () => {\r\n    try {\r\n      // API endpoint URL\r\n      const templateUrl = 'http://localhost:8000/api/templates/ai_template.xlsx';\r\n      \r\n      // Create a temporary anchor element to trigger download\r\n      const link = document.createElement('a');\r\n      link.href = templateUrl;\r\n      link.download = 'AI VP Template.xlsx'; // File name for download\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      \r\n      console.log('Template download initiated');\r\n    } catch (error) {\r\n      console.error('Error downloading template:', error);\r\n      // Fallback method if direct download doesn't work\r\n      window.open('http://localhost:8000/api/templates/ai_template.xlsx', '_blank');\r\n    }\r\n  };\r\n\r\n  return {\r\n    processedData,\r\n    aiProcessedData,\r\n    show3NFStatus,\r\n    showAIRearrangement,\r\n    showDefinitions,\r\n    toggleAIRearrangement,\r\n    toggle3NFCheck,\r\n    toggleShowDefinitions,\r\n    isExpanded,\r\n    toggleExpand,\r\n    handleDownloadTemplate\r\n  };\r\n};\r\n\r\nexport default useGraphVisualization;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}