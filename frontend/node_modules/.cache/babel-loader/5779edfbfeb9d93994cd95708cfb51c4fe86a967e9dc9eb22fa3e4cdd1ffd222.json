{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\R40008\\\\Asset Model Server\\\\python\\\\bim-ai-poc\\\\frontend\\\\src\\\\components\\\\GraphVisualization.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport * as go from \"gojs\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GraphVisualization = ({\n  graphData,\n  dimensions,\n  setDimensions\n}) => {\n  _s();\n  const diagramRef = useRef();\n  useEffect(() => {\n    if (graphData) {\n      const $ = go.GraphObject.make;\n\n      // Dispose of the old diagram if it exists\n      if (diagramRef.current) {\n        const existingDiagram = go.Diagram.fromDiv(diagramRef.current);\n        if (existingDiagram) {\n          existingDiagram.div = null; // Clears the previous diagram instance\n        }\n      }\n\n      // Create a new diagram with improved styling\n      const myDiagram = $(go.Diagram, diagramRef.current, {\n        \"undoManager.isEnabled\": true,\n        // Use a LayeredDigraphLayout for top-down hierarchy\n        layout: $(go.LayeredDigraphLayout, {\n          direction: 90,\n          // 90 degrees = downward direction\n          layerSpacing: 60,\n          // Spacing between layers\n          columnSpacing: 30,\n          // Spacing between nodes\n          setsPortSpots: false // Don't set port spots automatically\n        }),\n        initialContentAlignment: go.Spot.Center,\n        // Center the diagram in the viewport\n        \"animationManager.isEnabled\": true,\n        // Enable animations\n        \"toolManager.hoverDelay\": 100,\n        // Faster hover response\n        \"toolManager.mouseWheelBehavior\": go.ToolManager.WheelZoom // Mouse wheel zooms instead of scrolls\n      });\n\n      // Define node templates based on category\n      const nodeTemplates = new go.Map();\n\n      // System (Cluster) Node Template\n      nodeTemplates.add(\"system\", $(go.Node, \"Auto\", {\n        locationSpot: go.Spot.Center,\n        selectionAdorned: true,\n        selectionObjectName: \"SHAPE\",\n        mouseEnter: (e, obj) => showHover(e, obj),\n        mouseLeave: (e, obj) => hideHover(e, obj),\n        // Set port spots for connections\n        fromSpot: go.Spot.Bottom,\n        toSpot: go.Spot.Top\n      },\n      // Node shape with gradient fill\n      $(go.Shape, \"Rectangle\", {\n        name: \"SHAPE\",\n        fill: $(go.Brush, \"Linear\", {\n          0: \"#1E40AF\",\n          // Dark blue\n          1: \"#3B82F6\" // Medium blue\n        }),\n        stroke: \"#1E3A8A\",\n        strokeWidth: 2,\n        portId: \"\",\n        fromLinkable: true,\n        toLinkable: true,\n        cursor: \"pointer\",\n        width: 160,\n        height: 60\n      }),\n      // Header with icon\n      $(go.Panel, \"Horizontal\", {\n        alignment: go.Spot.TopCenter,\n        alignmentFocus: go.Spot.TopCenter,\n        margin: 8\n      }, $(go.Shape, \"Circle\", {\n        width: 16,\n        height: 16,\n        fill: \"white\",\n        margin: new go.Margin(0, 5, 0, 0)\n      }), $(go.TextBlock, {\n        font: \"bold 14px sans-serif\",\n        stroke: \"white\",\n        textAlign: \"center\",\n        margin: 2,\n        maxSize: new go.Size(140, NaN),\n        wrap: go.TextBlock.WrapFit\n      }, new go.Binding(\"text\", \"label\"))),\n      // Hover panel\n      $(go.Panel, \"Auto\", {\n        name: \"HOVER_PANEL\",\n        visible: false,\n        alignment: go.Spot.Bottom,\n        alignmentFocus: go.Spot.Top\n      }, $(go.Shape, \"RoundedRectangle\", {\n        fill: \"lightyellow\",\n        stroke: \"#E6C700\",\n        strokeWidth: 1,\n        parameter1: 4\n      }), $(go.TextBlock, {\n        margin: 8,\n        font: \"12px sans-serif\",\n        stroke: \"#333\",\n        textAlign: \"center\",\n        wrap: go.TextBlock.WrapFit,\n        maxSize: new go.Size(200, NaN)\n      }, new go.Binding(\"text\", \"hoverLabel\")))));\n\n      // Object Node Template\n      nodeTemplates.add(\"object\", $(go.Node, \"Auto\", {\n        locationSpot: go.Spot.Center,\n        selectionAdorned: true,\n        selectionObjectName: \"SHAPE\",\n        mouseEnter: (e, obj) => showHover(e, obj),\n        mouseLeave: (e, obj) => hideHover(e, obj),\n        // Set port spots for connections\n        fromSpot: go.Spot.Bottom,\n        toSpot: go.Spot.Top\n      }, $(go.Shape, \"RoundedRectangle\", {\n        name: \"SHAPE\",\n        fill: $(go.Brush, \"Linear\", {\n          0: \"#065F46\",\n          // Dark green\n          1: \"#10B981\" // Medium green\n        }),\n        stroke: \"#064E3B\",\n        strokeWidth: 2,\n        portId: \"\",\n        fromLinkable: true,\n        toLinkable: true,\n        cursor: \"pointer\",\n        width: 140,\n        height: 50\n      }), $(go.Panel, \"Horizontal\", {\n        alignment: go.Spot.TopCenter,\n        alignmentFocus: go.Spot.TopCenter,\n        margin: 8\n      }, $(go.Shape, \"Triangle\", {\n        width: 14,\n        height: 14,\n        fill: \"white\",\n        margin: new go.Margin(0, 5, 0, 0)\n      }), $(go.TextBlock, {\n        font: \"bold 13px sans-serif\",\n        stroke: \"white\",\n        margin: 2,\n        maxSize: new go.Size(120, NaN),\n        wrap: go.TextBlock.WrapFit\n      }, new go.Binding(\"text\", \"label\"))), $(go.Panel, \"Auto\", {\n        name: \"HOVER_PANEL\",\n        visible: false,\n        alignment: go.Spot.Bottom,\n        alignmentFocus: go.Spot.Top\n      }, $(go.Shape, \"RoundedRectangle\", {\n        fill: \"lightyellow\",\n        stroke: \"#E6C700\",\n        strokeWidth: 1,\n        parameter1: 4\n      }), $(go.TextBlock, {\n        margin: 8,\n        font: \"12px sans-serif\",\n        stroke: \"#333\",\n        textAlign: \"center\",\n        wrap: go.TextBlock.WrapFit,\n        maxSize: new go.Size(200, NaN)\n      }, new go.Binding(\"text\", \"hoverLabel\")))));\n\n      // Harmonised Attribute Node Template\n      nodeTemplates.add(\"harmonised\", $(go.Node, \"Auto\", {\n        locationSpot: go.Spot.Center,\n        selectionAdorned: true,\n        selectionObjectName: \"SHAPE\",\n        mouseEnter: (e, obj) => showHover(e, obj),\n        mouseLeave: (e, obj) => hideHover(e, obj),\n        // Set port spots for connections\n        fromSpot: go.Spot.Bottom,\n        toSpot: go.Spot.Top\n      }, $(go.Shape, \"RoundedRectangle\", {\n        name: \"SHAPE\",\n        fill: $(go.Brush, \"Linear\", {\n          0: \"#581C87\",\n          // Dark purple\n          1: \"#8B5CF6\" // Medium violet\n        }),\n        stroke: \"#4C1D95\",\n        strokeWidth: 2,\n        portId: \"\",\n        fromLinkable: true,\n        toLinkable: true,\n        cursor: \"pointer\",\n        width: 120,\n        height: 40\n      }), $(go.Panel, \"Horizontal\", {\n        alignment: go.Spot.TopCenter,\n        alignmentFocus: go.Spot.TopCenter,\n        margin: 6\n      }, $(go.Shape, \"Diamond\", {\n        width: 12,\n        height: 12,\n        fill: \"white\",\n        margin: new go.Margin(0, 5, 0, 0)\n      }), $(go.TextBlock, {\n        font: \"12px sans-serif\",\n        stroke: \"white\",\n        margin: 2,\n        maxSize: new go.Size(100, NaN),\n        wrap: go.TextBlock.WrapFit\n      }, new go.Binding(\"text\", \"label\"))), $(go.Panel, \"Auto\", {\n        name: \"HOVER_PANEL\",\n        visible: false,\n        alignment: go.Spot.Bottom,\n        alignmentFocus: go.Spot.Top\n      }, $(go.Shape, \"RoundedRectangle\", {\n        fill: \"lightyellow\",\n        stroke: \"#E6C700\",\n        strokeWidth: 1,\n        parameter1: 4\n      }), $(go.TextBlock, {\n        margin: 8,\n        font: \"12px sans-serif\",\n        stroke: \"#333\",\n        textAlign: \"center\",\n        wrap: go.TextBlock.WrapFit,\n        maxSize: new go.Size(200, NaN)\n      }, new go.Binding(\"text\", \"hoverLabel\")))));\n\n      // Set the node template map\n      myDiagram.nodeTemplateMap = nodeTemplates;\n\n      // Enhanced link template with orthogonal routing\n      myDiagram.linkTemplate = $(go.Link, {\n        routing: go.Link.Orthogonal,\n        // Use orthogonal routing for cleaner lines\n        corner: 10,\n        reshapable: true,\n        relinkableFrom: true,\n        relinkableTo: true\n      }, $(go.Shape, {\n        stroke: \"#555\",\n        strokeWidth: 2\n      }), $(go.Shape, {\n        toArrow: \"Triangle\",\n        fill: \"#555\",\n        stroke: null,\n        scale: 1.2\n      }));\n\n      // Hover functions\n      function showHover(e, obj) {\n        const hoverPanel = obj.findObject(\"HOVER_PANEL\");\n        if (hoverPanel && obj.data.hoverLabel) {\n          hoverPanel.visible = true;\n        }\n      }\n      function hideHover(e, obj) {\n        const hoverPanel = obj.findObject(\"HOVER_PANEL\");\n        if (hoverPanel) {\n          hoverPanel.visible = false;\n        }\n      }\n\n      // Process the graph data to use harmonised attributes and deduplicate within objects\n      const processedData = processGraphData(graphData);\n\n      // Set the model data with processed nodes and links\n      myDiagram.model = new go.GraphLinksModel(processedData.nodes, processedData.links);\n\n      // Adjust diagram dimensions after layout is complete\n      myDiagram.addDiagramListener(\"InitialLayoutCompleted\", () => {\n        const bounds = myDiagram.documentBounds;\n        setDimensions({\n          width: `${Math.ceil(bounds.width + 50)}px`,\n          // Add some padding\n          height: `${Math.ceil(bounds.height + 50)}px`\n        });\n      });\n    }\n  }, [graphData, setDimensions]);\n\n  // Process graph data to deduplicate harmonised attributes WITHIN each object\n  const processGraphData = data => {\n    if (!data || !data.nodeDataArray || !data.linkDataArray) {\n      return {\n        nodes: [],\n        links: []\n      };\n    }\n\n    // Copy the original arrays to avoid mutation\n    const originalNodes = [...data.nodeDataArray];\n    const originalLinks = [...data.linkDataArray];\n\n    // Get clusters and objects\n    const clusters = originalNodes.filter(node => node.category === \"system\");\n    const objects = originalNodes.filter(node => node.category === \"object\");\n\n    // Get attributes\n    const attributes = originalNodes.filter(node => node.category === \"attribute\");\n\n    // Create new arrays for the processed data\n    const newNodes = [...clusters, ...objects];\n    const newLinks = [];\n\n    // Keep cluster->object links\n    originalLinks.forEach(link => {\n      const sourceNode = originalNodes.find(node => node.key === link.from);\n      const targetNode = originalNodes.find(node => node.key === link.to);\n      if (sourceNode && targetNode && sourceNode.category === \"system\" && targetNode.category === \"object\") {\n        newLinks.push({\n          ...link\n        });\n      }\n    });\n\n    // Process each object separately\n    objects.forEach(object => {\n      // Find attributes linked to this object\n      const objectAttributes = [];\n      const objectAttributeLinks = [];\n      originalLinks.forEach(link => {\n        const sourceNode = originalNodes.find(node => node.key === link.from);\n        const targetNode = originalNodes.find(node => node.key === link.to);\n        if (sourceNode && targetNode && sourceNode.key === object.key && targetNode.category === \"attribute\") {\n          objectAttributes.push(targetNode);\n          objectAttributeLinks.push(link);\n        }\n      });\n\n      // Group by harmonised attribute name within this object\n      const harmonisedGroups = new Map();\n      objectAttributes.forEach(attr => {\n        const harmonisedName = attr.harmonisedAttribute || `Harmonised-${attr.label}`;\n        if (!harmonisedGroups.has(harmonisedName)) {\n          harmonisedGroups.set(harmonisedName, []);\n        }\n        harmonisedGroups.get(harmonisedName).push(attr);\n      });\n\n      // Create harmonised nodes for each unique harmonised attribute in this object\n      harmonisedGroups.forEach((attributeGroup, harmonisedName) => {\n        // Create a single harmonised node for this group\n        const harmonisedNodeKey = `harmonised-${object.key}-${harmonisedName}`;\n        const harmonisedNode = {\n          key: harmonisedNodeKey,\n          category: \"harmonised\",\n          label: harmonisedName,\n          hoverLabel: `Harmonised attribute for: ${attributeGroup.map(a => a.label).join(\", \")}`,\n          parentObject: object.key\n        };\n\n        // Add the harmonised node\n        newNodes.push(harmonisedNode);\n\n        // Add a link from the object to this harmonised attribute\n        newLinks.push({\n          from: object.key,\n          to: harmonisedNodeKey\n        });\n      });\n    });\n    console.log(\"Processed nodes:\", newNodes);\n    console.log(\"Processed links:\", newLinks);\n    return {\n      nodes: newNodes,\n      links: newLinks\n    };\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"graph-container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: diagramRef,\n      style: {\n        width: \"100%\",\n        height: dimensions.height,\n        border: \"1px solid #e2e8f0\",\n        borderRadius: \"8px\",\n        boxShadow: \"0 2px 4px rgba(0, 0, 0, 0.05)\",\n        background: \"#f8fafc\",\n        transition: \"all 0.3s ease\"\n      },\n      children: !graphData && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          height: \"100%\",\n          color: \"#64748b\",\n          fontSize: \"16px\",\n          fontStyle: \"italic\"\n        },\n        children: \"Graph will be displayed here after uploading a file.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 415,\n    columnNumber: 5\n  }, this);\n};\n_s(GraphVisualization, \"Iu16wR3n3MQey8BGIV6Jc19t6GQ=\");\n_c = GraphVisualization;\nexport default GraphVisualization;\nvar _c;\n$RefreshReg$(_c, \"GraphVisualization\");","map":{"version":3,"names":["React","useState","useEffect","useRef","go","jsxDEV","_jsxDEV","GraphVisualization","graphData","dimensions","setDimensions","_s","diagramRef","$","GraphObject","make","current","existingDiagram","Diagram","fromDiv","div","myDiagram","layout","LayeredDigraphLayout","direction","layerSpacing","columnSpacing","setsPortSpots","initialContentAlignment","Spot","Center","ToolManager","WheelZoom","nodeTemplates","Map","add","Node","locationSpot","selectionAdorned","selectionObjectName","mouseEnter","e","obj","showHover","mouseLeave","hideHover","fromSpot","Bottom","toSpot","Top","Shape","name","fill","Brush","stroke","strokeWidth","portId","fromLinkable","toLinkable","cursor","width","height","Panel","alignment","TopCenter","alignmentFocus","margin","Margin","TextBlock","font","textAlign","maxSize","Size","NaN","wrap","WrapFit","Binding","visible","parameter1","nodeTemplateMap","linkTemplate","Link","routing","Orthogonal","corner","reshapable","relinkableFrom","relinkableTo","toArrow","scale","hoverPanel","findObject","data","hoverLabel","processedData","processGraphData","model","GraphLinksModel","nodes","links","addDiagramListener","bounds","documentBounds","Math","ceil","nodeDataArray","linkDataArray","originalNodes","originalLinks","clusters","filter","node","category","objects","attributes","newNodes","newLinks","forEach","link","sourceNode","find","key","from","targetNode","to","push","object","objectAttributes","objectAttributeLinks","harmonisedGroups","attr","harmonisedName","harmonisedAttribute","label","has","set","get","attributeGroup","harmonisedNodeKey","harmonisedNode","map","a","join","parentObject","console","log","className","children","ref","style","border","borderRadius","boxShadow","background","transition","display","alignItems","justifyContent","color","fontSize","fontStyle","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/R40008/Asset Model Server/python/bim-ai-poc/frontend/src/components/GraphVisualization.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport * as go from \"gojs\";\r\n\r\nconst GraphVisualization = ({ graphData, dimensions, setDimensions }) => {\r\n  const diagramRef = useRef();\r\n\r\n  useEffect(() => {\r\n    if (graphData) {\r\n      const $ = go.GraphObject.make;\r\n\r\n      // Dispose of the old diagram if it exists\r\n      if (diagramRef.current) {\r\n        const existingDiagram = go.Diagram.fromDiv(diagramRef.current);\r\n        if (existingDiagram) {\r\n          existingDiagram.div = null; // Clears the previous diagram instance\r\n        }\r\n      }\r\n\r\n      // Create a new diagram with improved styling\r\n      const myDiagram = $(go.Diagram, diagramRef.current, {\r\n        \"undoManager.isEnabled\": true,\r\n        // Use a LayeredDigraphLayout for top-down hierarchy\r\n        layout: $(go.LayeredDigraphLayout, {\r\n          direction: 90, // 90 degrees = downward direction\r\n          layerSpacing: 60,  // Spacing between layers\r\n          columnSpacing: 30, // Spacing between nodes\r\n          setsPortSpots: false, // Don't set port spots automatically\r\n        }),\r\n        initialContentAlignment: go.Spot.Center, // Center the diagram in the viewport\r\n        \"animationManager.isEnabled\": true,      // Enable animations\r\n        \"toolManager.hoverDelay\": 100,          // Faster hover response\r\n        \"toolManager.mouseWheelBehavior\": go.ToolManager.WheelZoom, // Mouse wheel zooms instead of scrolls\r\n      });\r\n\r\n      // Define node templates based on category\r\n      const nodeTemplates = new go.Map();\r\n      \r\n      // System (Cluster) Node Template\r\n      nodeTemplates.add(\"system\",\r\n        $(go.Node, \"Auto\", \r\n          {\r\n            locationSpot: go.Spot.Center,\r\n            selectionAdorned: true,\r\n            selectionObjectName: \"SHAPE\",\r\n            mouseEnter: (e, obj) => showHover(e, obj),\r\n            mouseLeave: (e, obj) => hideHover(e, obj),\r\n            // Set port spots for connections\r\n            fromSpot: go.Spot.Bottom,\r\n            toSpot: go.Spot.Top\r\n          },\r\n          // Node shape with gradient fill\r\n          $(go.Shape, \"Rectangle\", {\r\n              name: \"SHAPE\",\r\n              fill: $(go.Brush, \"Linear\", { \r\n                0: \"#1E40AF\", // Dark blue\r\n                1: \"#3B82F6\"  // Medium blue\r\n              }),\r\n              stroke: \"#1E3A8A\",\r\n              strokeWidth: 2,\r\n              portId: \"\",\r\n              fromLinkable: true,\r\n              toLinkable: true,\r\n              cursor: \"pointer\",\r\n              width: 160,\r\n              height: 60,\r\n            }),\r\n          // Header with icon\r\n          $(go.Panel, \"Horizontal\", \r\n            { alignment: go.Spot.TopCenter, alignmentFocus: go.Spot.TopCenter, margin: 8 },\r\n            $(go.Shape, \"Circle\", {\r\n              width: 16, \r\n              height: 16, \r\n              fill: \"white\",\r\n              margin: new go.Margin(0, 5, 0, 0)\r\n            }),\r\n            $(go.TextBlock, \r\n              { \r\n                font: \"bold 14px sans-serif\", \r\n                stroke: \"white\",\r\n                textAlign: \"center\",\r\n                margin: 2,\r\n                maxSize: new go.Size(140, NaN),\r\n                wrap: go.TextBlock.WrapFit\r\n              },\r\n              new go.Binding(\"text\", \"label\"))\r\n          ),\r\n          // Hover panel\r\n          $(go.Panel, \"Auto\",\r\n            {\r\n              name: \"HOVER_PANEL\",\r\n              visible: false,\r\n              alignment: go.Spot.Bottom,\r\n              alignmentFocus: go.Spot.Top\r\n            },\r\n            $(go.Shape, \"RoundedRectangle\", {\r\n              fill: \"lightyellow\",\r\n              stroke: \"#E6C700\",\r\n              strokeWidth: 1,\r\n              parameter1: 4\r\n            }),\r\n            $(go.TextBlock, {\r\n              margin: 8,\r\n              font: \"12px sans-serif\",\r\n              stroke: \"#333\",\r\n              textAlign: \"center\",\r\n              wrap: go.TextBlock.WrapFit,\r\n              maxSize: new go.Size(200, NaN)\r\n            }, new go.Binding(\"text\", \"hoverLabel\"))\r\n          )\r\n        )\r\n      );\r\n      \r\n      // Object Node Template\r\n      nodeTemplates.add(\"object\",\r\n        $(go.Node, \"Auto\", \r\n          {\r\n            locationSpot: go.Spot.Center,\r\n            selectionAdorned: true,\r\n            selectionObjectName: \"SHAPE\",\r\n            mouseEnter: (e, obj) => showHover(e, obj),\r\n            mouseLeave: (e, obj) => hideHover(e, obj),\r\n            // Set port spots for connections\r\n            fromSpot: go.Spot.Bottom,\r\n            toSpot: go.Spot.Top\r\n          },\r\n          $(go.Shape, \"RoundedRectangle\", {\r\n            name: \"SHAPE\",\r\n            fill: $(go.Brush, \"Linear\", { \r\n              0: \"#065F46\", // Dark green\r\n              1: \"#10B981\"  // Medium green\r\n            }),\r\n            stroke: \"#064E3B\",\r\n            strokeWidth: 2,\r\n            portId: \"\",\r\n            fromLinkable: true,\r\n            toLinkable: true,\r\n            cursor: \"pointer\",\r\n            width: 140,\r\n            height: 50,\r\n          }),\r\n          $(go.Panel, \"Horizontal\", \r\n            { alignment: go.Spot.TopCenter, alignmentFocus: go.Spot.TopCenter, margin: 8 },\r\n            $(go.Shape, \"Triangle\", {\r\n              width: 14, \r\n              height: 14, \r\n              fill: \"white\",\r\n              margin: new go.Margin(0, 5, 0, 0)\r\n            }),\r\n            $(go.TextBlock, \r\n              { \r\n                font: \"bold 13px sans-serif\", \r\n                stroke: \"white\",\r\n                margin: 2,\r\n                maxSize: new go.Size(120, NaN),\r\n                wrap: go.TextBlock.WrapFit\r\n              },\r\n              new go.Binding(\"text\", \"label\"))\r\n          ),\r\n          $(go.Panel, \"Auto\",\r\n            {\r\n              name: \"HOVER_PANEL\",\r\n              visible: false,\r\n              alignment: go.Spot.Bottom,\r\n              alignmentFocus: go.Spot.Top\r\n            },\r\n            $(go.Shape, \"RoundedRectangle\", {\r\n              fill: \"lightyellow\",\r\n              stroke: \"#E6C700\",\r\n              strokeWidth: 1,\r\n              parameter1: 4\r\n            }),\r\n            $(go.TextBlock, {\r\n              margin: 8,\r\n              font: \"12px sans-serif\",\r\n              stroke: \"#333\",\r\n              textAlign: \"center\",\r\n              wrap: go.TextBlock.WrapFit,\r\n              maxSize: new go.Size(200, NaN)\r\n            }, new go.Binding(\"text\", \"hoverLabel\"))\r\n          )\r\n        )\r\n      );\r\n      \r\n      // Harmonised Attribute Node Template\r\n      nodeTemplates.add(\"harmonised\",\r\n        $(go.Node, \"Auto\", \r\n          {\r\n            locationSpot: go.Spot.Center,\r\n            selectionAdorned: true,\r\n            selectionObjectName: \"SHAPE\",\r\n            mouseEnter: (e, obj) => showHover(e, obj),\r\n            mouseLeave: (e, obj) => hideHover(e, obj),\r\n            // Set port spots for connections\r\n            fromSpot: go.Spot.Bottom,\r\n            toSpot: go.Spot.Top\r\n          },\r\n          $(go.Shape, \"RoundedRectangle\", {\r\n            name: \"SHAPE\",\r\n            fill: $(go.Brush, \"Linear\", { \r\n              0: \"#581C87\", // Dark purple\r\n              1: \"#8B5CF6\"  // Medium violet\r\n            }),\r\n            stroke: \"#4C1D95\",\r\n            strokeWidth: 2,\r\n            portId: \"\",\r\n            fromLinkable: true,\r\n            toLinkable: true,\r\n            cursor: \"pointer\",\r\n            width: 120,\r\n            height: 40,\r\n          }),\r\n          $(go.Panel, \"Horizontal\", \r\n            { alignment: go.Spot.TopCenter, alignmentFocus: go.Spot.TopCenter, margin: 6 },\r\n            $(go.Shape, \"Diamond\", {\r\n              width: 12, \r\n              height: 12, \r\n              fill: \"white\",\r\n              margin: new go.Margin(0, 5, 0, 0)\r\n            }),\r\n            $(go.TextBlock, \r\n              { \r\n                font: \"12px sans-serif\", \r\n                stroke: \"white\",\r\n                margin: 2,\r\n                maxSize: new go.Size(100, NaN),\r\n                wrap: go.TextBlock.WrapFit\r\n              },\r\n              new go.Binding(\"text\", \"label\"))\r\n          ),\r\n          $(go.Panel, \"Auto\",\r\n            {\r\n              name: \"HOVER_PANEL\",\r\n              visible: false,\r\n              alignment: go.Spot.Bottom,\r\n              alignmentFocus: go.Spot.Top\r\n            },\r\n            $(go.Shape, \"RoundedRectangle\", {\r\n              fill: \"lightyellow\",\r\n              stroke: \"#E6C700\",\r\n              strokeWidth: 1,\r\n              parameter1: 4\r\n            }),\r\n            $(go.TextBlock, {\r\n              margin: 8,\r\n              font: \"12px sans-serif\",\r\n              stroke: \"#333\",\r\n              textAlign: \"center\",\r\n              wrap: go.TextBlock.WrapFit,\r\n              maxSize: new go.Size(200, NaN)\r\n            }, new go.Binding(\"text\", \"hoverLabel\"))\r\n          )\r\n        )\r\n      );\r\n\r\n      // Set the node template map\r\n      myDiagram.nodeTemplateMap = nodeTemplates;\r\n      \r\n      // Enhanced link template with orthogonal routing\r\n      myDiagram.linkTemplate =\r\n        $(go.Link,\r\n          {\r\n            routing: go.Link.Orthogonal, // Use orthogonal routing for cleaner lines\r\n            corner: 10,\r\n            reshapable: true,\r\n            relinkableFrom: true,\r\n            relinkableTo: true,\r\n          },\r\n          $(go.Shape,\r\n            {\r\n              stroke: \"#555\",\r\n              strokeWidth: 2,\r\n            }),\r\n          $(go.Shape,\r\n            {\r\n              toArrow: \"Triangle\",\r\n              fill: \"#555\",\r\n              stroke: null,\r\n              scale: 1.2\r\n            })\r\n        );\r\n\r\n      // Hover functions\r\n      function showHover(e, obj) {\r\n        const hoverPanel = obj.findObject(\"HOVER_PANEL\");\r\n        if (hoverPanel && obj.data.hoverLabel) {\r\n          hoverPanel.visible = true;\r\n        }\r\n      }\r\n      \r\n      function hideHover(e, obj) {\r\n        const hoverPanel = obj.findObject(\"HOVER_PANEL\");\r\n        if (hoverPanel) {\r\n          hoverPanel.visible = false;\r\n        }\r\n      }\r\n\r\n      // Process the graph data to use harmonised attributes and deduplicate within objects\r\n      const processedData = processGraphData(graphData);\r\n\r\n      // Set the model data with processed nodes and links\r\n      myDiagram.model = new go.GraphLinksModel(\r\n        processedData.nodes,\r\n        processedData.links\r\n      );\r\n\r\n      // Adjust diagram dimensions after layout is complete\r\n      myDiagram.addDiagramListener(\"InitialLayoutCompleted\", () => {\r\n        const bounds = myDiagram.documentBounds;\r\n        setDimensions({\r\n          width: `${Math.ceil(bounds.width + 50)}px`, // Add some padding\r\n          height: `${Math.ceil(bounds.height + 50)}px`,\r\n        });\r\n      });\r\n    }\r\n  }, [graphData, setDimensions]);\r\n\r\n  // Process graph data to deduplicate harmonised attributes WITHIN each object\r\n  const processGraphData = (data) => {\r\n    if (!data || !data.nodeDataArray || !data.linkDataArray) {\r\n      return { nodes: [], links: [] };\r\n    }\r\n\r\n    // Copy the original arrays to avoid mutation\r\n    const originalNodes = [...data.nodeDataArray];\r\n    const originalLinks = [...data.linkDataArray];\r\n    \r\n    // Get clusters and objects\r\n    const clusters = originalNodes.filter(node => node.category === \"system\");\r\n    const objects = originalNodes.filter(node => node.category === \"object\");\r\n    \r\n    // Get attributes\r\n    const attributes = originalNodes.filter(node => node.category === \"attribute\");\r\n    \r\n    // Create new arrays for the processed data\r\n    const newNodes = [...clusters, ...objects];\r\n    const newLinks = [];\r\n    \r\n    // Keep cluster->object links\r\n    originalLinks.forEach(link => {\r\n      const sourceNode = originalNodes.find(node => node.key === link.from);\r\n      const targetNode = originalNodes.find(node => node.key === link.to);\r\n      \r\n      if (sourceNode && targetNode && \r\n          sourceNode.category === \"system\" && \r\n          targetNode.category === \"object\") {\r\n        newLinks.push({...link});\r\n      }\r\n    });\r\n    \r\n    // Process each object separately\r\n    objects.forEach(object => {\r\n      // Find attributes linked to this object\r\n      const objectAttributes = [];\r\n      const objectAttributeLinks = [];\r\n      \r\n      originalLinks.forEach(link => {\r\n        const sourceNode = originalNodes.find(node => node.key === link.from);\r\n        const targetNode = originalNodes.find(node => node.key === link.to);\r\n        \r\n        if (sourceNode && targetNode && \r\n            sourceNode.key === object.key && \r\n            targetNode.category === \"attribute\") {\r\n          objectAttributes.push(targetNode);\r\n          objectAttributeLinks.push(link);\r\n        }\r\n      });\r\n      \r\n      // Group by harmonised attribute name within this object\r\n      const harmonisedGroups = new Map();\r\n      \r\n      objectAttributes.forEach(attr => {\r\n        const harmonisedName = attr.harmonisedAttribute || `Harmonised-${attr.label}`;\r\n        \r\n        if (!harmonisedGroups.has(harmonisedName)) {\r\n          harmonisedGroups.set(harmonisedName, []);\r\n        }\r\n        \r\n        harmonisedGroups.get(harmonisedName).push(attr);\r\n      });\r\n      \r\n      // Create harmonised nodes for each unique harmonised attribute in this object\r\n      harmonisedGroups.forEach((attributeGroup, harmonisedName) => {\r\n        // Create a single harmonised node for this group\r\n        const harmonisedNodeKey = `harmonised-${object.key}-${harmonisedName}`;\r\n        \r\n        const harmonisedNode = {\r\n          key: harmonisedNodeKey,\r\n          category: \"harmonised\",\r\n          label: harmonisedName,\r\n          hoverLabel: `Harmonised attribute for: ${attributeGroup.map(a => a.label).join(\", \")}`,\r\n          parentObject: object.key\r\n        };\r\n        \r\n        // Add the harmonised node\r\n        newNodes.push(harmonisedNode);\r\n        \r\n        // Add a link from the object to this harmonised attribute\r\n        newLinks.push({\r\n          from: object.key,\r\n          to: harmonisedNodeKey\r\n        });\r\n      });\r\n    });\r\n    \r\n    console.log(\"Processed nodes:\", newNodes);\r\n    console.log(\"Processed links:\", newLinks);\r\n    \r\n    return {\r\n      nodes: newNodes,\r\n      links: newLinks\r\n    };\r\n  };\r\n\r\n  return (\r\n    <div className=\"graph-container\">\r\n      <div\r\n        ref={diagramRef}\r\n        style={{\r\n          width: \"100%\",\r\n          height: dimensions.height,\r\n          border: \"1px solid #e2e8f0\",\r\n          borderRadius: \"8px\",\r\n          boxShadow: \"0 2px 4px rgba(0, 0, 0, 0.05)\",\r\n          background: \"#f8fafc\",\r\n          transition: \"all 0.3s ease\",\r\n        }}\r\n      >\r\n        {!graphData && (\r\n          <div style={{\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            height: \"100%\",\r\n            color: \"#64748b\",\r\n            fontSize: \"16px\",\r\n            fontStyle: \"italic\"\r\n          }}>\r\n            Graph will be displayed here after uploading a file.\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GraphVisualization;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}